function slideshow(d,k){function g(m){var p=m.length;while(p>0){var n=Math.floor(Math.random()*p);p--;var o=m[p];m[p]=m[n];m[n]=o}return m}var i=g(d),h=-1,l=createElem("a"),c=createElem("a"),a=document.getElementById("home_banner_photo"),j=document.getElementById("home_slideshow_controls");if(!i.length){a.style.backgroundImage="url("+k+")";document.getElementById("home_caption_shadow").style.display="none";return}j.appendChild(createElem("div",{className:"slideshow_caption"},l,c));if(i.length>1){j.appendChild(createElem("div",{className:"slideshow_nav"},createElem("a",{className:"slideshow_nav_prev",href:"javascript:void(0)",mouseover:function(){b(h-1)},click:function(){setTimeout(function(){f(h-1);b(h-1)},10)}},createElem("span","\xab")),createElem("a",{className:"slideshow_nav_next",href:"javascript:void(0)",mouseover:function(){b(h+1)},click:function(){setTimeout(function(){f(h+1);b(h+1)},10)}},createElem("span","\xbb"))))}function b(m){var n=i[(m+i.length)%i.length];if(!n.elem&&!n.preload){n.preload=new Image();n.preload.src=n.url}}function f(n){n=(n+i.length)%i.length;if(h!=-1){i[h].elem.style.display="none"}var p=i[n];if(!p.elem){var m=p.elem=createElem("img",{src:p.url});m.style.left=(-p.x||0)+"px";m.style.top=(-p.y||0)+"px";a.appendChild(m)}p.elem.style.display="block";l.href=p.href;c.href=p.href;removeChildren(c);removeChildren(l);l.appendChild(document.createTextNode(p.caption));c.appendChild(document.createTextNode(p.org));h=n;var o=p.caption||p.org}function e(){for(var m=0;m<i.length;m++){if(i[m].weight>=Math.random()){return m}}return 0}f(e())};